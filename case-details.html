<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Case Details - AI Advocates</title>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #4f46e5;
        --primary-dark: #3730a3;
        --primary-light: #6366f1;
        --secondary: #10b981;
        --background: #f8fafc;
        --surface: #ffffff;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --text-muted: #94a3b8;
        --border: #e2e8f0;
        --border-active: #4f46e5;
        --success: #10b981;
        --error: #ef4444;
        --warning: #f59e0b;
        --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }

      body {
        font-family: "Inter", sans-serif;
        background: var(--background);
        color: var(--text-primary);
        line-height: 1.6;
        overflow-x: hidden;
      }

      .app-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
        min-height: 100vh;
        padding-bottom: 80px;
      }

      /* Header Styles */
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin: 2rem 0;
        gap: 2rem;
      }

      .page-info {
        flex: 1;
      }

      .page-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
      }

      .page-subtitle {
        color: var(--text-secondary);
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      .breadcrumb {
        list-style: none;
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        padding: 0;
      }

      .breadcrumb-item {
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      .breadcrumb-item:not(:last-child)::after {
        content: ">";
        margin-left: 0.5rem;
        color: var(--text-muted);
      }

      .breadcrumb-item:last-child {
        color: var(--primary);
        font-weight: 500;
      }

      .page-actions {
        display: flex;
        gap: 0.75rem;
        flex-shrink: 0;
      }

      .btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 0.5rem;
        font-weight: 500;
        font-size: 0.875rem;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s ease;
        text-decoration: none;
        background: var(--surface);
      }

      .btn-primary {
        background: var(--primary);
        color: white;
      }

      .btn-primary:hover {
        background: var(--primary-dark);
        transform: translateY(-1px);
        box-shadow: var(--shadow-lg);
      }

      .btn-secondary {
        background: var(--surface);
        color: var(--text-secondary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        background: var(--background);
        border-color: var(--border-active);
        color: var(--primary);
      }

      .btn-warning {
        background: var(--warning);
        color: white;
      }

      .btn-warning:hover {
        background: #d97706;
        transform: translateY(-1px);
        box-shadow: var(--shadow-lg);
      }

      /* Case Header Card */
      .case-header-card {
        background: var(--surface);
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 2rem;
      }

      .case-title-section {
        flex: 1;
      }

      .case-title {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
      }

      .case-subtitle {
        color: var(--text-secondary);
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      .case-status-row {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.025em;
      }

      .status-badge.active {
        background: #dcfce7;
        color: #166534;
      }

      .status-badge.pending {
        background: #fef3c7;
        color: #92400e;
      }

      .status-badge.criminal {
        background: #fecaca;
        color: #991b1b;
      }

      .status-badge.civil {
        background: #dbeafe;
        color: #1e40af;
      }

      .tags-container {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .tag {
        background: var(--background);
        color: var(--text-secondary);
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        border: 1px solid var(--border);
      }

      .case-quick-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        flex-shrink: 0;
        min-width: 400px;
      }

      .quick-info-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
      }

      .info-label {
        font-size: 0.75rem;
        font-weight: 500;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .info-value {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--text-primary);
      }

      /* Tab Navigation */
      .tab-navigation {
        background: var(--surface);
        border-radius: 1rem;
        padding: 0.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .tab-buttons {
        display: flex;
        gap: 0.25rem;
      }

      .tab-btn {
        flex: 1;
        padding: 0.75rem 1.5rem;
        border: none;
        background: transparent;
        color: var(--text-secondary);
        font-weight: 500;
        border-radius: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 0.875rem;
      }

      .tab-btn.active {
        background: var(--primary);
        color: white;
        box-shadow: var(--shadow);
      }

      .tab-btn:hover:not(.active) {
        background: var(--background);
        color: var(--text-primary);
      }

      /* Tab Content */
      .tab-content {
        min-height: 400px;
      }

      .tab-pane {
        display: none;
      }

      .tab-pane.active {
        display: block;
      }

      /* Content Container */
      .content-container {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 2rem;
      }

      .main-details,
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      /* Section Styles */
      .detail-section {
        background: var(--surface);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
      }

      .section-icon {
        width: 20px;
        height: 20px;
        color: var(--primary);
      }

      .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
      }

      .section-content {
        color: var(--text-secondary);
      }

      .detail-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
      }

      .detail-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
      }

      .detail-label {
        font-size: 0.75rem;
        font-weight: 500;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .detail-value {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--text-primary);
      }

      /* Document Styles */
      .document-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .document-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--background);
        border-radius: 0.75rem;
        border: 1px solid var(--border);
        transition: all 0.2s ease;
      }

      .document-item:hover {
        border-color: var(--border-active);
        box-shadow: var(--shadow);
      }

      .document-info {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex: 1;
      }

      .document-icon {
        width: 40px;
        height: 40px;
        border-radius: 0.5rem;
        background: var(--primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
      }

      .document-details {
        flex: 1;
      }

      .document-name {
        font-weight: 500;
        color: var(--text-primary);
        margin-bottom: 0.25rem;
      }

      .document-meta {
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .document-actions {
        display: flex;
        gap: 0.5rem;
      }

      .doc-action-btn {
        width: 32px;
        height: 32px;
        border: none;
        background: var(--surface);
        color: var(--text-secondary);
        border-radius: 0.375rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        border: 1px solid var(--border);
      }

      .doc-action-btn:hover {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      /* Timeline Styles */
      .timeline {
        position: relative;
        padding-left: 2rem;
      }

      .timeline::before {
        content: "";
        position: absolute;
        left: 0.75rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--border);
      }

      .timeline-item {
        position: relative;
        margin-bottom: 2rem;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        left: -0.375rem;
        top: 0.5rem;
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
        background: var(--primary);
        border: 2px solid var(--surface);
      }

      .timeline-content {
        background: var(--background);
        padding: 1rem;
        border-radius: 0.75rem;
        border: 1px solid var(--border);
      }

      .timeline-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
      }

      .timeline-title {
        font-weight: 500;
        color: var(--text-primary);
      }

      .timeline-date {
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .timeline-description {
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      /* Hearings Styles */
      .hearings-container {
        padding: 0;
      }

      .hearings-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding: 0 1rem;
      }

      .hearings-header h2 {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .hearings-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
      }

      .hearings-section {
        background: var(--surface);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .hearings-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .hearing-item {
        background: var(--background);
        border-radius: 0.75rem;
        padding: 1.5rem;
        border: 1px solid var(--border);
        transition: all 0.2s ease;
      }

      .hearing-item:hover {
        border-color: var(--border-active);
        box-shadow: var(--shadow);
      }

      .hearing-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
      }

      .hearing-date {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 1rem;
      }

      .hearing-status {
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .hearing-status.scheduled {
        background: #dbeafe;
        color: #1e40af;
      }

      .hearing-status.completed {
        background: #dcfce7;
        color: #166534;
      }

      .hearing-status.adjourned {
        background: #fef3c7;
        color: #92400e;
      }

      .hearing-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .hearing-detail {
        display: flex;
        flex-direction: column;
      }

      .hearing-label {
        font-size: 0.75rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.25rem;
      }

      .hearing-value {
        font-size: 0.875rem;
        color: var(--text-primary);
        font-weight: 500;
      }

      .hearing-notes {
        font-size: 0.875rem;
        color: var(--text-secondary);
        line-height: 1.5;
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        border-top: 1px solid var(--border);
      }

      .hearing-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .action-btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.375rem;
        font-size: 0.75rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .action-btn.edit {
        background: var(--warning);
        color: white;
      }

      .action-btn.view {
        background: var(--primary);
        color: white;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1rem;
      }

      .modal-content {
        background: var(--surface);
        border-radius: 1rem;
        box-shadow: var(--shadow-xl);
        width: 100%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--border);
      }

      .modal-header h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .modal-close {
        width: 32px;
        height: 32px;
        border: none;
        background: transparent;
        color: var(--text-secondary);
        cursor: pointer;
        border-radius: 0.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-close:hover {
        background: var(--background);
        color: var(--text-primary);
      }

      .modal-body {
        padding: 2rem;
      }

      .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
        padding: 1.5rem 2rem;
        border-top: 1px solid var(--border);
      }

      /* Form Styles */
      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .form-group.full-width {
        grid-column: 1 / -1;
      }

      .form-group label {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--text-primary);
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        padding: 0.75rem;
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        font-size: 0.875rem;
        transition: all 0.2s ease;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: var(--border-active);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      .form-group textarea {
        resize: vertical;
        min-height: 80px;
      }

      /* Bottom Navigation */
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--surface);
        border-top: 1px solid var(--border);
        padding: 1rem 0;
        z-index: 100;
      }

      .nav-items {
        display: flex;
        justify-content: space-around;
        align-items: center;
        max-width: 500px;
        margin: 0 auto;
        padding: 0 1rem;
      }

      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: var(--text-muted);
        font-size: 0.75rem;
        transition: all 0.2s ease;
        padding: 0.5rem;
        border-radius: 0.5rem;
        min-width: 60px;
      }

      .nav-item i {
        font-size: 1.25rem;
        margin-bottom: 0.25rem;
      }

      .nav-item:hover,
      .nav-item.active {
        color: var(--primary);
        background: rgba(79, 70, 229, 0.1);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .app-container {
          padding: 0 0.5rem;
          padding-bottom: 80px;
        }

        .page-header {
          flex-direction: column;
          gap: 1rem;
        }

        .page-actions {
          flex-wrap: wrap;
        }

        .case-header-card {
          flex-direction: column;
          gap: 1.5rem;
        }

        .case-quick-info {
          min-width: auto;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: 1rem;
        }

        .content-container {
          grid-template-columns: 1fr;
          gap: 1.5rem;
        }

        .hearings-grid {
          grid-template-columns: 1fr;
        }

        .hearing-info {
          grid-template-columns: 1fr;
        }

        .tab-buttons {
          flex-wrap: wrap;
        }

        .tab-btn {
          flex: 1;
          min-width: 120px;
        }

        .modal-content {
          margin: 1rem;
          max-width: calc(100vw - 2rem);
        }

        .form-grid {
          grid-template-columns: 1fr;
        }
      }

      /* Full width containers for non-overview tabs */
      .documents-container,
      .timeline-container {
        background: var(--surface);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: var(--text-muted);
      }

      .empty-state i {
        font-size: 3rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .empty-state p {
        font-size: 1rem;
        margin-bottom: 1rem;
      }

      /* AI Assistant Styles */
      .ai-assistant-container {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        height: calc(100vh - 300px);
      }

      .ai-summary-section {
        background: var(--surface);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .ai-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        margin-left: auto;
      }

      .ai-summary-content {
        display: grid;
        gap: 1.5rem;
        margin-top: 1rem;
      }

      .case-summary-card {
        background: var(--background);
        border-radius: 0.75rem;
        padding: 1.5rem;
        border: 1px solid var(--border);
      }

      .case-summary-card h4 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.75rem;
      }

      .summary-text {
        color: var(--text-secondary);
        line-height: 1.6;
      }

      .risk-assessment {
        background: var(--background);
        border-radius: 0.75rem;
        padding: 1.5rem;
        border: 1px solid var(--border);
      }

      .risk-assessment h4 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 1rem;
      }

      .risk-score-bar {
        width: 100%;
        height: 8px;
        background: var(--border);
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .risk-progress {
        height: 100%;
        background: linear-gradient(90deg, #f59e0b 0%, #ef4444 100%);
        transition: width 0.3s ease;
      }

      .risk-value {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-primary);
        float: right;
      }

      .ai-suggestions {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
        background: var(--background);
        border-radius: 0.75rem;
        padding: 1.5rem;
        border: 1px solid var(--border);
      }

      .suggestion-column h4 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 1rem;
      }

      .suggestion-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .suggestion-list li {
        padding: 0.5rem 0;
        color: var(--text-secondary);
        font-size: 0.875rem;
        line-height: 1.5;
      }

      .priority-high {
        color: #ef4444;
      }

      .priority-medium {
        color: #f59e0b;
      }

      .priority-low {
        color: #10b981;
      }

      /* AI Chat Styles */
      .ai-chat-section {
        background: var(--surface);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 400px;
      }

      .chat-container {
        display: flex;
        flex-direction: column;
        height: 100%;
        margin-top: 1rem;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
        background: var(--background);
        border-radius: 0.75rem;
        border: 1px solid var(--border);
        margin-bottom: 1rem;
        max-height: 300px;
      }

      .message {
        display: flex;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
        align-items: flex-start;
      }

      .message.user-message {
        flex-direction: row-reverse;
      }

      .message-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        flex-shrink: 0;
      }

      .ai-message .message-avatar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .user-message .message-avatar {
        background: var(--primary);
        color: white;
      }

      .message-content {
        flex: 1;
        max-width: 80%;
      }

      .message-text {
        background: var(--surface);
        padding: 0.75rem 1rem;
        border-radius: 1rem;
        border: 1px solid var(--border);
        color: var(--text-primary);
        line-height: 1.5;
        font-size: 0.875rem;
      }

      .user-message .message-text {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      .message-time {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-top: 0.25rem;
        padding: 0 1rem;
      }

      .user-message .message-time {
        text-align: right;
      }

      .chat-input-area {
        margin-top: auto;
      }

      .quick-actions {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
      }

      .quick-action-btn {
        padding: 0.5rem 1rem;
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--text-secondary);
        border-radius: 0.5rem;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .quick-action-btn:hover {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      .chat-input-container {
        display: flex;
        gap: 0.75rem;
        align-items: center;
      }

      .chat-input-container input {
        flex: 1;
        padding: 0.75rem 1rem;
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        font-size: 0.875rem;
        background: var(--surface);
      }

      .chat-input-container input:focus {
        outline: none;
        border-color: var(--border-active);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      .send-btn {
        padding: 0.75rem 1.5rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .send-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-1px);
      }

      /* Responsive adjustments for AI Assistant */
      @media (max-width: 768px) {
        .ai-assistant-container {
          height: auto;
        }

        .ai-suggestions {
          grid-template-columns: 1fr;
        }

        .quick-actions {
          grid-template-columns: 1fr 1fr;
          display: grid;
        }

        .quick-action-btn {
          justify-content: center;
        }

        .message-content {
          max-width: 85%;
        }
      }
    </style>
  </head>

  <body>
    <div class="app-container">
      <div class="app-content">
        <!-- Page Header -->
        <div class="page-header">
          <div class="page-info">
            <nav class="breadcrumb">
              <span class="breadcrumb-item">Dashboard</span>
              <span class="breadcrumb-item">Cases</span>
              <span class="breadcrumb-item">
                <i class="fas fa-eye"></i>
                Case Details
              </span>
            </nav>

            <p class="page-subtitle">
              Complete case information and proceedings
            </p>
          </div>

          <div class="page-actions">
            <button
              class="btn btn-secondary"
              onclick="window.location.href='cases.html'"
            >
              <i class="fas fa-arrow-left"></i>
              Back to Cases
            </button>
            <button class="btn btn-warning" onclick="editCase()">
              <i class="fas fa-edit"></i>
              Edit Case
            </button>
            <button class="btn btn-primary" onclick="openAddUpdateModal()">
              <i class="fas fa-plus"></i>
              Add Update
            </button>
          </div>
        </div>

        <!-- Case Header Card -->
        <div class="case-header-card">
          <div class="case-title-section">
            <h2 class="case-title" id="caseTitle">State vs. John Doe</h2>
            <p class="case-subtitle" id="caseSubtitle">
              Client: John Doe | Opponent: State of Delhi
            </p>

            <div class="case-status-row">
              <span class="status-badge active">Active</span>
              <span class="status-badge criminal">Criminal</span>
              <div class="tags-container">
                <span class="tag">Bail Application</span>
                <span class="tag">Section 420</span>
                <span class="tag">Economic Offense</span>
              </div>
            </div>
          </div>

          <div class="case-quick-info">
            <div class="quick-info-item">
              <span class="info-label">Case Number</span>
              <span class="info-value" id="caseNumber">CC/1234/2024</span>
            </div>
            <div class="quick-info-item">
              <span class="info-label">Court</span>
              <span class="info-value" id="courtName"
                >District Court, Delhi</span
              >
            </div>
            <div class="quick-info-item">
              <span class="info-label">Judge</span>
              <span class="info-value" id="judgeName"
                >Hon'ble Justice A.K. Sharma</span
              >
            </div>
            <div class="quick-info-item">
              <span class="info-label">Next Hearing</span>
              <span class="info-value" id="nextHearing">January 15, 2024</span>
            </div>
            <div class="quick-info-item">
              <span class="info-label">Filed Date</span>
              <span class="info-value" id="filedDate">December 20, 2023</span>
            </div>
            <div class="quick-info-item">
              <span class="info-label">Senior Advocate</span>
              <span class="info-value" id="seniorAdvocate">Priya Sharma</span>
            </div>
          </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
          <div class="tab-buttons">
            <button class="tab-btn active" data-tab="overview">Overview</button>
            <button class="tab-btn" data-tab="hearings">Hearings</button>
            <button class="tab-btn" data-tab="documents">Documents</button>
            <button class="tab-btn" data-tab="timeline">Timeline</button>
            <button class="tab-btn" data-tab="ai-assistant">AI Assistant</button>
          </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Overview Tab -->
          <div class="tab-pane active" id="overview-tab">
            <div class="content-container">
              <!-- Main Details Column -->
              <div class="main-details">
                <!-- Case Information -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-info-circle section-icon"></i>
                    <h3 class="section-title">Case Information</h3>
                  </div>
                  <div class="section-content">
                    <div class="detail-grid">
                      <div class="detail-item">
                        <span class="detail-label">Case Type</span>
                        <span class="detail-value">Criminal</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Jurisdiction</span>
                        <span class="detail-value">Delhi East</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Police Station</span>
                        <span class="detail-value">Laxmi Nagar PS</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">FIR Number</span>
                        <span class="detail-value">FIR/456/2023</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">IPC Sections</span>
                        <span class="detail-value">420, 406, 34</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Stage</span>
                        <span class="detail-value">Trial Stage</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Parties Involved -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-users section-icon"></i>
                    <h3 class="section-title">Parties Involved</h3>
                  </div>
                  <div class="section-content">
                    <div class="detail-grid">
                      <div class="detail-item">
                        <span class="detail-label">Petitioner/Complainant</span>
                        <span class="detail-value">State of Delhi</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Respondent/Accused</span>
                        <span class="detail-value">John Doe</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Client</span>
                        <span class="detail-value">John Doe</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Client Contact</span>
                        <span class="detail-value">+91 9876543210</span>
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Client Address</span>
                        <span class="detail-value"
                          >123, ABC Colony, Delhi - 110092</span
                        >
                      </div>
                      <div class="detail-item">
                        <span class="detail-label">Opposite Counsel</span>
                        <span class="detail-value">Public Prosecutor</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Case Summary -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-file-text section-icon"></i>
                    <h3 class="section-title">Case Summary</h3>
                  </div>
                  <div class="section-content">
                    <p style="color: var(--text-secondary); line-height: 1.6">
                      The case involves allegations of cheating and criminal breach
                      of trust against the accused John Doe. The complainant alleges
                      that the accused fraudulently obtained Rs. 5,00,000 by
                      promising to deliver construction materials for a residential
                      project but failed to deliver as per the agreement. The
                      accused has been charged under IPC Sections 420 (cheating),
                      406 (criminal breach of trust), and 34 (common intention). The
                      matter is currently at the trial stage with the prosecution
                      examining witnesses.
                    </p>
                  </div>
                </div>
              </div>

              <!-- Sidebar -->
              <div class="sidebar">
                <!-- Team Assignment -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-user-friends section-icon"></i>
                    <h3 class="section-title">Team Assignment</h3>
                  </div>
                  <div class="section-content">
                    <div class="detail-item" style="margin-bottom: 1rem">
                      <span class="detail-label">Senior Advocate</span>
                      <span class="detail-value">Priya Sharma</span>
                    </div>
                    <div class="detail-item" style="margin-bottom: 1rem">
                      <span class="detail-label">Junior Advocates</span>
                      <span class="detail-value">Amit Jain, Neha Gupta</span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">Case Researcher</span>
                      <span class="detail-value">Suresh Patel</span>
                    </div>
                  </div>
                </div>

                <!-- Financial Information -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-rupee-sign section-icon"></i>
                    <h3 class="section-title">Financial Details</h3>
                  </div>
                  <div class="section-content">
                    <div class="detail-item" style="margin-bottom: 1rem">
                      <span class="detail-label">Total Fee</span>
                      <span class="detail-value">₹2,50,000</span>
                    </div>
                    <div class="detail-item" style="margin-bottom: 1rem">
                      <span class="detail-label">Amount Paid</span>
                      <span class="detail-value">₹1,50,000</span>
                    </div>
                    <div class="detail-item" style="margin-bottom: 1rem">
                      <span class="detail-label">Balance Due</span>
                      <span class="detail-value" style="color: var(--error)"
                        >₹1,00,000</span
                      >
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">Payment Status</span>
                      <span class="detail-value">Partial</span>
                    </div>
                  </div>
                </div>

                <!-- Case History -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-history section-icon"></i>
                    <h3 class="section-title">Case History</h3>
                  </div>
                  <div class="section-content">
                    <!-- Previous Advocate Information -->
                    <div id="previousAdvocateInfo" style="background: var(--background); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; border: 1px solid var(--border);">
                      <h4 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">
                        <i class="fas fa-user-tie" style="color: var(--primary); margin-right: 0.5rem;"></i>
                        Previous Advocate Details
                      </h4>
                      <div class="detail-grid">
                        <div class="detail-item">
                          <span class="detail-label">Previous Advocate</span>
                          <span class="detail-value" id="prevAdvocateName">Mr. Rajesh Kumar</span>
                        </div>
                        <div class="detail-item">
                          <span class="detail-label">Registration No.</span>
                          <span class="detail-value" id="prevAdvocateReg">D/1234/2015</span>
                        </div>
                        <div class="detail-item">
                          <span class="detail-label">Law Firm</span>
                          <span class="detail-value" id="prevLawFirm">Kumar & Associates</span>
                        </div>
                        <div class="detail-item">
                          <span class="detail-label">Period Handled</span>
                          <span class="detail-value" id="prevPeriod">Jan 2023 - Nov 2023</span>
                        </div>
                        <div class="detail-item">
                          <span class="detail-label">Transfer Reason</span>
                          <span class="detail-value" id="transferReason">Specialization Required</span>
                        </div>
                        <div class="detail-item">
                          <span class="detail-label">Handover Date</span>
                          <span class="detail-value" id="handoverDate">December 15, 2023</span>
                        </div>
                      </div>
                      <div style="margin-top: 1rem;">
                        <span class="detail-label">Handover Remarks</span>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); line-height: 1.5; font-size: 0.875rem;" id="handoverRemarks">
                          Case was transferred due to requirement of specialized expertise in economic offenses. All documents have been properly handed over along with complete case history and client briefing notes.
                        </p>
                      </div>
                    </div>

                    <!-- Historical Events Timeline -->
                    <div style="background: var(--background); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                      <h4 style="color: var(--text-primary); margin-bottom: 1.5rem; font-size: 1rem; font-weight: 600;">
                        <i class="fas fa-clock" style="color: var(--primary); margin-right: 0.5rem;"></i>
                        Historical Events
                      </h4>
                      <div class="timeline" id="caseHistoryTimeline">
                        <!-- Case history events will be populated here -->
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Recent Updates -->
                <div class="detail-section">
                  <div class="section-header">
                    <i class="fas fa-clock section-icon"></i>
                    <h3 class="section-title">Recent Updates</h3>
                  </div>
                  <div class="section-content">
                    <div class="timeline">
                      <div class="timeline-item">
                        <div class="timeline-content">
                          <div class="timeline-header">
                            <span class="timeline-title">Bail Application Filed</span>
                            <span class="timeline-date">Dec 22, 2023</span>
                          </div>
                          <div class="timeline-description">
                            Bail application submitted to the court.
                          </div>
                        </div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-content">
                          <div class="timeline-header">
                            <span class="timeline-title">FIR Received</span>
                            <span class="timeline-date">Dec 20, 2023</span>
                          </div>
                          <div class="timeline-description">
                            Copy of FIR obtained from police station.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Hearings Tab -->
          <div class="tab-pane" id="hearings-tab">
            <div class="hearings-container">
              <div class="hearings-header">
                <h2>Case Hearings</h2>
                <button class="btn btn-primary" onclick="openAddHearingModal()">
                  <i class="fas fa-plus"></i>
                  Add Hearing
                </button>
              </div>

              <div class="hearings-grid">
                <!-- Upcoming Hearings -->
                <div class="hearings-section">
                  <h3 class="section-title">
                    <i class="fas fa-calendar-plus"></i>
                    Upcoming Hearings
                  </h3>
                  <div class="hearings-list" id="upcomingHearings">
                    <!-- Upcoming hearings will be populated here -->
                  </div>
                </div>

                <!-- Past Hearings -->
                <div class="hearings-section">
                  <h3 class="section-title">
                    <i class="fas fa-history"></i>
                    Past Hearings
                  </h3>
                  <div class="hearings-list" id="pastHearings">
                    <!-- Past hearings will be populated here -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Documents Tab -->
          <div class="tab-pane" id="documents-tab">
            <div class="documents-container">
              <div class="section-header">
                <i class="fas fa-folder section-icon"></i>
                <h3 class="section-title">All Documents</h3>
                <button class="btn btn-primary" style="margin-left: auto;">
                  <i class="fas fa-plus"></i>
                  Add Document
                </button>
              </div>
              <div class="section-content">
                <div class="document-list" id="allDocuments">
                  <!-- Documents will be populated here -->
                </div>
              </div>
            </div>
          </div>

          <!-- Timeline Tab -->
          <div class="tab-pane" id="timeline-tab">
            <div class="timeline-container">
              <div class="section-header">
                <i class="fas fa-history section-icon"></i>
                <h3 class="section-title">Complete Case Timeline</h3>
              </div>
              <div class="section-content">
                <div class="timeline" id="fullTimeline">
                  <!-- Timeline will be populated here -->
                </div>
              </div>
            </div>
          </div>

          <!-- AI Assistant Tab -->
          <div class="tab-pane" id="ai-assistant-tab">
            <div class="ai-assistant-container">
              <!-- AI Case Summary Section -->
              <div class="ai-summary-section">
                <div class="section-header">
                  <i class="fas fa-robot section-icon"></i>
                  <h3 class="section-title">AI Case Summary</h3>
                  <span class="ai-badge">AI-generated analysis and recommendations</span>
                </div>

                <div class="ai-summary-content">
                  <div class="case-summary-card">
                    <h4>AI Case Summary</h4>
                    <p class="summary-text">Criminal case involving economic offense under Section 420 IPC. Client seeking anticipatory bail.</p>
                  </div>

                  <div class="risk-assessment">
                    <h4>Risk Score</h4>
                    <div class="risk-score-bar">
                      <div class="risk-progress" style="width: 65%;"></div>
                    </div>
                    <span class="risk-value">65/100</span>
                  </div>

                  <div class="ai-suggestions">
                    <div class="suggestion-column">
                      <h4>Suggested Arguments</h4>
                      <ul class="suggestion-list">
                        <li><span class="priority-high">●●●</span> Previous bail precedents in economic offense cases</li>
                        <li><span class="priority-medium">●●</span> Clear criminal record of the accused</li>
                        <li><span class="priority-low">●</span> Cooperation with investigation</li>
                      </ul>
                    </div>

                    <div class="suggestion-column">
                      <h4>Suggested Documents</h4>
                      <ul class="suggestion-list">
                        <li>• Character witness affidavits</li>
                        <li>• Property documents for surety</li>
                        <li>• Employment verification letter</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <!-- AI Assistant Chat Section -->
              <div class="ai-chat-section">
                <div class="section-header">
                  <i class="fas fa-comments section-icon"></i>
                  <h3 class="section-title">AI Assistant Chat</h3>
                  <span class="ai-badge">Chat with AI for case-specific guidance and analysis</span>
                </div>

                <div class="chat-container">
                  <div class="chat-messages" id="chatMessages">
                    <!-- Initial AI message -->
                    <div class="message ai-message">
                      <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                      </div>
                      <div class="message-content">
                        <div class="message-text">
                          Hello! I'm your AI assistant for this case. I can help you with legal research, draft arguments, suggest case strategies, and analyze documents. What would you like to discuss about "State vs. John Doe"?
                        </div>
                        <div class="message-time">AI Assistant • Just now</div>
                      </div>
                    </div>

                    <!-- Sample user message -->
                    <div class="message user-message">
                      <div class="message-content">
                        <div class="message-text">
                          What are the chances of getting bail approved for this economic offense case?
                        </div>
                        <div class="message-time">You • 2 min ago</div>
                      </div>
                      <div class="message-avatar">
                        <i class="fas fa-user"></i>
                      </div>
                    </div>

                    <!-- Sample AI response -->
                    <div class="message ai-message">
                      <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                      </div>
                      <div class="message-content">
                        <div class="message-text">
                          Based on the case details, here's my analysis for bail prospects:
                          <br><br>
                          <strong>• Positive factors:</strong> Clean criminal record, cooperation with investigation
                          <br><strong>• Challenges:</strong> Economic offense under Section 420 IPC
                          <br><strong>• Recommendation:</strong> Strong surety and property documents will improve chances
                          <br><br>
                          Would you like me to draft arguments or suggest specific legal precedents?
                        </div>
                        <div class="message-time">AI Assistant • Just now</div>
                      </div>
                    </div>
                  </div>

                  <div class="chat-input-area">
                    <div class="quick-actions">
                      <button class="quick-action-btn" onclick="sendQuickMessage('Analyze Documents')">
                        <i class="fas fa-file-alt"></i> Analyze Documents
                      </button>
                      <button class="quick-action-btn" onclick="sendQuickMessage('Suggest Arguments')">
                        <i class="fas fa-balance-scale"></i> Suggest Arguments
                      </button>
                      <button class="quick-action-btn" onclick="sendQuickMessage('Draft Motion')">
                        <i class="fas fa-edit"></i> Draft Motion
                      </button>
                      <button class="quick-action-btn" onclick="sendQuickMessage('Risk Assessment')">
                        <i class="fas fa-chart-line"></i> Risk Assessment
                      </button>
                    </div>

                    <div class="chat-input-container">
                      <input type="text" id="chatInput" placeholder="Ask AI about case strategy, legal precedents, document review..." />
                      <button class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                        Send
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Hearing Modal -->
      <div class="modal-overlay" id="addHearingModal" style="display: none;">
        <div class="modal-content add-hearing-modal">
          <div class="modal-header">
            <h3>Add New Hearing</h3>
            <button class="modal-close" onclick="closeAddHearingModal()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <form id="addHearingForm">
              <div class="form-grid">
                <div class="form-group">
                  <label for="hearingDate">Hearing Date *</label>
                  <input type="datetime-local" id="hearingDate" name="hearingDate" required>
                </div>
                <div class="form-group">
                  <label for="courtName">Court Name *</label>
                  <input type="text" id="courtName" name="courtName" placeholder="e.g. Delhi District Court" required>
                </div>
                <div class="form-group">
                  <label for="courtRoom">Court Hall/Room No.</label>
                  <input type="text" id="courtRoom" name="courtRoom" placeholder="e.g. Court Room 7">
                </div>
                <div class="form-group">
                  <label for="judgeName">Bench/Judge Name</label>
                  <input type="text" id="judgeName" name="judgeName" placeholder="e.g. Hon'ble Justice XYZ">
                </div>
                <div class="form-group">
                  <label for="hearingType">Hearing Type</label>
                  <select id="hearingType" name="hearingType">
                    <option value="">Select Type</option>
                    <option value="Status">Status</option>
                    <option value="Evidence">Evidence</option>
                    <option value="Bail">Bail</option>
                    <option value="Arguments">Arguments</option>
                    <option value="Judgment">Judgment</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="caseStage">Case Stage</label>
                  <select id="caseStage" name="caseStage">
                    <option value="">Select Stage</option>
                    <option value="Pre-trial">Pre-trial</option>
                    <option value="Trial">Trial</option>
                    <option value="Post-trial">Post-trial</option>
                    <option value="Appeal">Appeal</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="hearingStatus">Hearing Status</label>
                  <select id="hearingStatus" name="hearingStatus">
                    <option value="Scheduled">Scheduled</option>
                    <option value="Completed">Completed</option>
                    <option value="Adjourned">Adjourned</option>
                    <option value="Cancelled">Cancelled</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="nextHearingDate">Next Hearing Date</label>
                  <input type="datetime-local" id="nextHearingDate" name="nextHearingDate">
                </div>
                <div class="form-group">
                  <label for="appearedBy">Appeared By</label>
                  <input type="text" id="appearedBy" name="appearedBy" placeholder="Lawyer name who appeared">
                </div>
              </div>
              <div class="form-group full-width">
                <label for="hearingNotes">Notes/Outcome</label>
                <textarea id="hearingNotes" name="hearingNotes" rows="4" placeholder="What happened during the hearing..."></textarea>
              </div>
              <div class="form-group full-width">
                <label for="documentsDiscussed">Documents Discussed</label>
                <textarea id="documentsDiscussed" name="documentsDiscussed" rows="3" placeholder="List of documents discussed in the hearing..."></textarea>
              </div>
              <div class="form-group full-width">
                <label for="aiSummary">AI Summary</label>
                <textarea id="aiSummary" name="aiSummary" rows="3" placeholder="AI-generated summary of the hearing..."></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeAddHearingModal()">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="saveHearing()">Save Hearing</button>
          </div>
        </div>
      </div>

      <!-- Add Update Modal -->
      <div class="modal-overlay" id="addUpdateModal" style="display: none;">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Case Update</h3>
            <button class="modal-close" onclick="closeAddUpdateModal()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <form id="addUpdateForm">
              <div class="form-grid">
                <div class="form-group">
                  <label for="updateTitle">Update Title *</label>
                  <input type="text" id="updateTitle" name="updateTitle" placeholder="e.g., Document Submitted, Hearing Completed" required>
                </div>
                <div class="form-group">
                  <label for="updateDate">Update Date *</label>
                  <input type="datetime-local" id="updateDate" name="updateDate" required>
                </div>
                <div class="form-group">
                  <label for="updateCategory">Category</label>
                  <select id="updateCategory" name="updateCategory">
                    <option value="">Select Category</option>
                    <option value="Hearing">Hearing</option>
                    <option value="Document">Document</option>
                    <option value="Payment">Payment</option>
                    <option value="Client Meeting">Client Meeting</option>
                    <option value="Research">Research</option>
                    <option value="Court Filing">Court Filing</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="updateStatus">Priority</label>
                  <select id="updatePriority" name="updatePriority">
                    <option value="Low">Low</option>
                    <option value="Medium" selected>Medium</option>
                    <option value="High">High</option>
                    <option value="Urgent">Urgent</option>
                  </select>
                </div>
              </div>
              <div class="form-group full-width">
                <label for="updateNotes">Update Notes *</label>
                <textarea id="updateNotes" name="updateNotes" rows="4" placeholder="Detailed notes about this update..." required></textarea>
              </div>
              <div class="form-group full-width">
                <label for="nextAction">Next Action Required</label>
                <textarea id="nextAction" name="nextAction" rows="2" placeholder="What needs to be done next..."></textarea>
              </div>
              <div class="form-group full-width">
                <label for="documentsAttached">Documents Attached</label>
                <input type="text" id="documentsAttached" name="documentsAttached" placeholder="List any documents related to this update">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeAddUpdateModal()">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="saveUpdate()">Add Update</button>
          </div>
        </div>
      </div>

      <!-- Bottom Navigation -->
      <div class="bottom-nav">
        <div class="nav-items">
          <a href="home.html" class="nav-item">
            <i class="fas fa-home"></i>
            Home
          </a>
          <a href="team.html" class="nav-item">
            <i class="fas fa-users"></i>
            My Team
          </a>
          <a href="cases.html" class="nav-item active">
            <i class="fas fa-file-alt"></i>
            Cases
          </a>
          <a href="calendar.html" class="nav-item">
            <i class="fas fa-calendar"></i>
            Calendar
          </a>
          <a href="more.html" class="nav-item">
            <i class="fas fa-th"></i>
            More
          </a>
        </div>
      </div>
    </div>

    <script>
      // Sample hearings data
      let hearingsData = [
        {
          id: 1,
          date: "2024-01-15T10:30:00",
          courtName: "District Court, Delhi",
          courtRoom: "Court Room 7",
          judgeName: "Hon'ble Justice A.K. Sharma",
          hearingType: "Bail",
          caseStage: "Pre-trial",
          status: "scheduled",
          appearedBy: "Priya Sharma",
          notes: "Bail application to be presented",
          documentsDiscussed: "Bail application, Surety documents",
          aiSummary: "",
          nextHearingDate: ""
        },
        {
          id: 2,
          date: "2024-01-18T14:00:00",
          courtName: "District Court, Delhi",
          courtRoom: "Court Room 5",
          judgeName: "Hon'ble Justice B.K. Patel",
          hearingType: "Evidence",
          caseStage: "Trial",
          status: "scheduled",
          appearedBy: "Amit Jain",
          notes: "Witness examination scheduled",
          documentsDiscussed: "Evidence files, Witness statements",
          aiSummary: "",
          nextHearingDate: ""
        },
        {
          id: 3,
          date: "2023-12-20T11:00:00",
          courtName: "District Court, Delhi",
          courtRoom: "Court Room 7",
          judgeName: "Hon'ble Justice A.K. Sharma",
          hearingType: "Status",
          caseStage: "Pre-trial",
          status: "completed",
          appearedBy: "Priya Sharma",
          notes: "Initial hearing completed. Case registered successfully. Next hearing for bail application scheduled.",
          documentsDiscussed: "FIR copy, Complaint application, Legal notice",
          aiSummary: "First hearing conducted successfully. Court registered the case and scheduled next hearing for bail application. All initial documents were submitted and accepted by the court.",
          nextHearingDate: "2024-01-15T10:30:00"
        },
        {
          id: 4,
          date: "2023-12-22T15:30:00",
          courtName: "District Court, Delhi",
          courtRoom: "Court Room 7",
          judgeName: "Hon'ble Justice A.K. Sharma",
          hearingType: "Status",
          caseStage: "Pre-trial",
          status: "adjourned",
          appearedBy: "Neha Gupta",
          notes: "Hearing adjourned due to judge unavailability. Rescheduled for next week.",
          documentsDiscussed: "None",
          aiSummary: "Hearing was adjourned and rescheduled due to court calendar conflicts.",
          nextHearingDate: "2024-01-15T10:30:00"
        }
      ];

      $(document).ready(function () {
        // Load case details and hearings
        loadCaseDetails();
        loadHearings();
        loadDocuments();
        loadTimeline();
        loadCaseHistory();
        initializeAIAssistant();

        // Tab functionality
        $('.tab-btn').on('click', function() {
          const tab = $(this).data('tab');
          switchTab(tab);
        });

        // Navigation
        $(".nav-item").on("click", function (e) {
          const href = $(this).attr("href");
          if (href && href !== "#") {
            window.location.href = href;
          }
        });
      });

      function switchTab(tabName) {
        // Remove active class from all tabs and panes
        $('.tab-btn').removeClass('active');
        $('.tab-pane').removeClass('active');
        
        // Add active class to selected tab and pane
        $(`.tab-btn[data-tab="${tabName}"]`).addClass('active');
        $(`#${tabName}-tab`).addClass('active');
      }

      function loadHearings() {
        const now = new Date();
        const upcomingHearings = hearingsData.filter(hearing => new Date(hearing.date) > now);
        const pastHearings = hearingsData.filter(hearing => new Date(hearing.date) <= now);

        // Load upcoming hearings
        const upcomingContainer = $('#upcomingHearings');
        if (upcomingHearings.length === 0) {
          upcomingContainer.html(`
            <div class="empty-state">
              <i class="fas fa-calendar-alt"></i>
              <p>No upcoming hearings scheduled</p>
            </div>
          `);
        } else {
          upcomingContainer.html(upcomingHearings.map(hearing => createHearingCard(hearing)).join(''));
        }

        // Load past hearings
        const pastContainer = $('#pastHearings');
        if (pastHearings.length === 0) {
          pastContainer.html(`
            <div class="empty-state">
              <i class="fas fa-history"></i>
              <p>No past hearings recorded</p>
            </div>
          `);
        } else {
          pastContainer.html(pastHearings.map(hearing => createHearingCard(hearing)).join(''));
        }
      }

      function createHearingCard(hearing) {
        const hearingDate = new Date(hearing.date);
        const formattedDate = hearingDate.toLocaleDateString('en-IN', {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
        const formattedTime = hearingDate.toLocaleTimeString('en-IN', {
          hour: '2-digit',
          minute: '2-digit'
        });

        return `
          <div class="hearing-item">
            <div class="hearing-header">
              <div>
                <div class="hearing-date">${formattedDate}</div>
                <div style="color: var(--text-secondary); font-size: 0.875rem;">${formattedTime}</div>
              </div>
              <span class="hearing-status ${hearing.status}">${hearing.status}</span>
            </div>
            
            <div class="hearing-info">
              <div class="hearing-detail">
                <div class="hearing-label">Court</div>
                <div class="hearing-value">${hearing.courtName}</div>
              </div>
              <div class="hearing-detail">
                <div class="hearing-label">Room</div>
                <div class="hearing-value">${hearing.courtRoom || 'N/A'}</div>
              </div>
              <div class="hearing-detail">
                <div class="hearing-label">Judge</div>
                <div class="hearing-value">${hearing.judgeName || 'N/A'}</div>
              </div>
              <div class="hearing-detail">
                <div class="hearing-label">Type</div>
                <div class="hearing-value">${hearing.hearingType || 'N/A'}</div>
              </div>
              <div class="hearing-detail">
                <div class="hearing-label">Stage</div>
                <div class="hearing-value">${hearing.caseStage || 'N/A'}</div>
              </div>
              <div class="hearing-detail">
                <div class="hearing-label">Appeared By</div>
                <div class="hearing-value">${hearing.appearedBy || 'N/A'}</div>
              </div>
            </div>
            
            ${hearing.notes ? `<div class="hearing-notes">${hearing.notes}</div>` : ''}
            
            <div class="hearing-actions">
              <button class="action-btn edit" onclick="editHearing(${hearing.id})">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="action-btn view" onclick="viewHearingDetails(${hearing.id})">
                <i class="fas fa-eye"></i> View Details
              </button>
            </div>
          </div>
        `;
      }

      function loadDocuments() {
        const documents = [
          {
            name: "FIR Copy",
            type: "PDF",
            size: "2.3 MB",
            date: "2023-12-20",
            icon: "fas fa-file-pdf"
          },
          {
            name: "Bail Application",
            type: "DOC",
            size: "1.8 MB",
            date: "2023-12-22",
            icon: "fas fa-file-word"
          },
          {
            name: "Evidence Photos",
            type: "JPG",
            size: "5.2 MB",
            date: "2023-12-25",
            icon: "fas fa-file-image"
          },
          {
            name: "Witness Statement",
            type: "PDF",
            size: "1.1 MB",
            date: "2024-01-05",
            icon: "fas fa-file-pdf"
          }
        ];

        const documentsContainer = $('#allDocuments');
        documentsContainer.html(documents.map(doc => `
          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="${doc.icon}"></i>
              </div>
              <div class="document-details">
                <div class="document-name">${doc.name}</div>
                <div class="document-meta">${doc.type} • ${doc.size} • Uploaded ${doc.date}</div>
              </div>
            </div>
            <div class="document-actions">
              <button class="doc-action-btn" title="Download">
                <i class="fas fa-download"></i>
              </button>
              <button class="doc-action-btn" title="View">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
        `).join(''));
      }

      function loadTimeline() {
        const timelineEvents = [
          {
            title: "Bail Application Filed",
            date: "Dec 22, 2023",
            description: "Bail application submitted to the court for the accused."
          },
          {
            title: "FIR Received",
            date: "Dec 20, 2023",
            description: "Copy of FIR obtained from the police station."
          },
          {
            title: "Case Filed",
            date: "Dec 18, 2023",
            description: "Initial case registration and client consultation completed."
          },
          {
            title: "Client Consultation",
            date: "Dec 15, 2023",
            description: "First meeting with client to understand case details."
          }
        ];

        const timelineContainer = $('#fullTimeline');
        timelineContainer.html(timelineEvents.map(event => `
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-header">
                <span class="timeline-title">${event.title}</span>
                <span class="timeline-date">${event.date}</span>
              </div>
              <div class="timeline-description">${event.description}</div>
            </div>
          </div>
        `).join(''));
      }

      function loadCaseHistory() {
        // Sample case history data - would come from backend
        const caseHistory = [
          {
            date: "Nov 15, 2023",
            eventType: "Filing",
            court: "Magistrate Court, Delhi",
            judge: "Hon'ble Magistrate R.K. Singh",
            remarks: "Initial complaint filed by State against accused. Case registered under Section 420 IPC.",
            orderSummary: "Case registered and cognizance taken. Summons issued to accused.",
            docType: "Complaint Application",
            appealStatus: "Not Applicable",
            previousAdvocate: "Adv. Ramesh Gupta"
          },
          {
            date: "Nov 20, 2023",
            eventType: "Hearing",
            court: "Magistrate Court, Delhi",
            judge: "Hon'ble Magistrate R.K. Singh",
            remarks: "First hearing. Accused appeared through previous counsel. Matter adjourned for filing reply.",
            orderSummary: "Accused granted 15 days time to file written reply. Next date fixed.",
            docType: "Order Copy",
            appealStatus: "No",
            previousAdvocate: "Adv. Ramesh Gupta"
          },
          {
            date: "Dec 05, 2023",
            eventType: "Evidence Submission",
            court: "Magistrate Court, Delhi",
            judge: "Hon'ble Magistrate R.K. Singh",
            remarks: "Documentary evidence submitted by prosecution. Bank statements and transaction records filed.",
            orderSummary: "Evidence marked as exhibits. Copy provided to defense counsel.",
            docType: "Evidence Document",
            appealStatus: "No",
            previousAdvocate: "Adv. Ramesh Gupta"
          },
          {
            date: "Dec 10, 2023",
            eventType: "Adjournment",
            court: "Magistrate Court, Delhi",
            judge: "Hon'ble Magistrate R.K. Singh",
            remarks: "Case transferred to current advocate. Previous counsel withdrew appearance. Adjournment granted.",
            orderSummary: "New advocate allowed to file appearance. Case adjourned for preparation.",
            docType: "Order Copy",
            appealStatus: "No",
            previousAdvocate: "Adv. Ramesh Gupta (Withdrew)"
          }
        ];

        const historyContainer = $('#caseHistoryTimeline');

        if (caseHistory.length === 0) {
          historyContainer.html(`
            <div style="text-align: center; color: var(--text-muted); padding: 2rem;">
              <i class="fas fa-history" style="font-size: 2rem; opacity: 0.5; margin-bottom: 1rem; display: block;"></i>
              <p>No previous case history available</p>
            </div>
          `);
        } else {
          historyContainer.html(caseHistory.map(item => `
            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-header">
                  <span class="timeline-title">${item.eventType} - ${item.court}</span>
                  <span class="timeline-date">${item.date}</span>
                </div>
                <div class="timeline-description">
                  <strong>Judge:</strong> ${item.judge}<br>
                  <strong>Event:</strong> ${item.remarks}<br>
                  ${item.orderSummary ? `<strong>Order/Decision:</strong> ${item.orderSummary}<br>` : ''}
                  ${item.docType ? `<strong>Document Type:</strong> ${item.docType}<br>` : ''}
                  ${item.previousAdvocate ? `<strong>Handled By:</strong> ${item.previousAdvocate}<br>` : ''}
                  <strong>Appeal Status:</strong> ${item.appealStatus}
                </div>
              </div>
            </div>
          `).join(''));
        }
      }

      function openAddHearingModal() {
        $('#addHearingModal').show();
        // Set default date to tomorrow
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(10, 0);
        $('#hearingDate').val(tomorrow.toISOString().slice(0, 16));
      }

      function closeAddHearingModal() {
        $('#addHearingModal').hide();
        $('#addHearingForm')[0].reset();
      }

      function saveHearing() {
        const form = $('#addHearingForm')[0];
        const formData = new FormData(form);
        
        // Basic validation
        if (!formData.get('hearingDate') || !formData.get('courtName')) {
          alert('Please fill in all required fields');
          return;
        }

        // Create new hearing object
        const newHearing = {
          id: hearingsData.length + 1,
          date: formData.get('hearingDate'),
          courtName: formData.get('courtName'),
          courtRoom: formData.get('courtRoom'),
          judgeName: formData.get('judgeName'),
          hearingType: formData.get('hearingType'),
          caseStage: formData.get('caseStage'),
          status: formData.get('hearingStatus'),
          appearedBy: formData.get('appearedBy'),
          notes: formData.get('hearingNotes'),
          documentsDiscussed: formData.get('documentsDiscussed'),
          aiSummary: formData.get('aiSummary'),
          nextHearingDate: formData.get('nextHearingDate')
        };

        // Add to hearings data
        hearingsData.push(newHearing);
        
        // Reload hearings
        loadHearings();
        
        // Close modal
        closeAddHearingModal();
        
        alert('Hearing added successfully!');
      }

      function editHearing(hearingId) {
        const hearing = hearingsData.find(h => h.id === hearingId);
        if (hearing) {
          // Populate form with hearing data
          $('#hearingDate').val(hearing.date);
          $('#courtName').val(hearing.courtName);
          $('#courtRoom').val(hearing.courtRoom);
          $('#judgeName').val(hearing.judgeName);
          $('#hearingType').val(hearing.hearingType);
          $('#caseStage').val(hearing.caseStage);
          $('#hearingStatus').val(hearing.status);
          $('#appearedBy').val(hearing.appearedBy);
          $('#hearingNotes').val(hearing.notes);
          $('#documentsDiscussed').val(hearing.documentsDiscussed);
          $('#aiSummary').val(hearing.aiSummary);
          $('#nextHearingDate').val(hearing.nextHearingDate);
          
          // Update modal title and save function
          $('.modal-header h3').text('Edit Hearing');
          openAddHearingModal();
        }
      }

      function viewHearingDetails(hearingId) {
        const hearing = hearingsData.find(h => h.id === hearingId);
        if (hearing) {
          // Create a detailed view of the hearing
          const hearingDate = new Date(hearing.date);
          const formattedDate = hearingDate.toLocaleDateString('en-IN', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });

          let details = `
            <strong>Date & Time:</strong> ${formattedDate}<br>
            <strong>Court:</strong> ${hearing.courtName}<br>
            <strong>Room:</strong> ${hearing.courtRoom || 'N/A'}<br>
            <strong>Judge:</strong> ${hearing.judgeName || 'N/A'}<br>
            <strong>Type:</strong> ${hearing.hearingType || 'N/A'}<br>
            <strong>Stage:</strong> ${hearing.caseStage || 'N/A'}<br>
            <strong>Status:</strong> ${hearing.status}<br>
            <strong>Appeared By:</strong> ${hearing.appearedBy || 'N/A'}<br><br>
          `;
          
          if (hearing.notes) {
            details += `<strong>Notes:</strong><br>${hearing.notes}<br><br>`;
          }
          
          if (hearing.documentsDiscussed) {
            details += `<strong>Documents Discussed:</strong><br>${hearing.documentsDiscussed}<br><br>`;
          }
          
          if (hearing.aiSummary) {
            details += `<strong>AI Summary:</strong><br>${hearing.aiSummary}`;
          }

          alert(details);
        }
      }

      function loadCaseDetails() {
        // Get case ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const caseId = urlParams.get("id");

        if (caseId) {
          const caseData = getCaseDataById(caseId);
          if (caseData) {
            populateCaseDetails(caseData);
          }
        }
      }

      function getCaseDataById(caseId) {
        // Sample case data - in reality this would come from your backend
        const casesData = {
          1: {
            title: "State vs. John Doe",
            subtitle: "Client: John Doe | Opponent: State of Delhi",
            caseNumber: "CC/1234/2024",
            court: "District Court, Delhi",
            judge: "Hon'ble Justice A.K. Sharma",
            nextHearing: "January 15, 2024",
            filedDate: "December 20, 2023",
            seniorAdvocate: "Priya Sharma",
            status: "Active",
            type: "Criminal",
          },
          2: {
            title: "Smith Property Dispute",
            subtitle: "Client: Mr. Smith | Opponent: ABC Developers",
            caseNumber: "CS/5678/2024",
            court: "High Court, Delhi",
            judge: "Hon'ble Justice B.K. Patel",
            nextHearing: "January 18, 2024",
            filedDate: "December 15, 2023",
            seniorAdvocate: "Rajesh Kumar",
            status: "Pending",
            type: "Civil",
          },
        };

        return casesData[caseId] || casesData["1"]; // Default to case 1 if not found
      }

      function populateCaseDetails(caseData) {
        // Update the page with actual case data
        $("#caseTitle").text(caseData.title);
        $("#caseSubtitle").text(caseData.subtitle);
        $("#caseNumber").text(caseData.caseNumber);
        $("#courtName").text(caseData.court);
        $("#judgeName").text(caseData.judge);
        $("#nextHearing").text(caseData.nextHearing);
        $("#filedDate").text(caseData.filedDate);
        $("#seniorAdvocate").text(caseData.seniorAdvocate);

        // Update status badges based on case data
        updateStatusBadges(caseData.status, caseData.type);
      }

      function updateStatusBadges(status, type) {
        // Update status badges dynamically
        const statusBadges = document.querySelectorAll(".status-badge");
        statusBadges.forEach((badge) => {
          if (badge.textContent === status || badge.textContent === type) {
            // Keep existing badges that match
            return;
          }
        });
      }

      // Modal overlay click to close
      $('#addHearingModal').on('click', function(e) {
        if (e.target === this) {
          closeAddHearingModal();
        }
      });

      // Document actions
      $(document).on('click', '.doc-action-btn', function(e) {
        e.preventDefault();
        const action = $(this).attr('title');
        const documentName = $(this).closest('.document-item').find('.document-name').text();

        if (action === 'Download') {
          alert(`Downloading ${documentName}...`);
        } else if (action === 'View') {
          alert(`Opening ${documentName} for viewing...`);
        }
      });

      // AI Assistant initialization
      function initializeAIAssistant() {
        // Initialize chat with welcome message
        console.log('AI Assistant initialized');
      }

      // AI Assistant Chat Functions
      function sendMessage() {
        const input = $('#chatInput');
        const message = input.val().trim();

        if (message) {
          addUserMessage(message);
          input.val('');

          // Simulate AI response after a short delay
          setTimeout(() => {
            addAIResponse(message);
          }, 1000);
        }
      }

      function sendQuickMessage(action) {
        addUserMessage(action);

        // Simulate AI response based on the action
        setTimeout(() => {
          let response = '';
          switch(action) {
            case 'Analyze Documents':
              response = 'I\'ve analyzed the case documents. The FIR shows strong evidence, but there are opportunities for defense. The bail application is well-drafted. Would you like me to suggest improvements?';
              break;
            case 'Suggest Arguments':
              response = 'Based on similar cases, I recommend focusing on: 1) Clean criminal record, 2) Cooperation with investigation, 3) Economic hardship if denied bail. Shall I draft detailed arguments?';
              break;
            case 'Draft Motion':
              response = 'I can help draft a bail motion. Key points to include: precedent cases, constitutional rights, and surety arrangements. What specific motion would you like me to prepare?';
              break;
            case 'Risk Assessment':
              response = 'Current risk assessment shows 65/100. Main risks: Economic offense charges. Mitigation factors: Clean record, cooperation. Recommendations: Strong surety, community ties evidence.';
              break;
            default:
              response = 'I\'m here to help with your case. Please let me know what specific assistance you need.';
          }
          addAIResponse(response, true);
        }, 1500);
      }

      function addUserMessage(message) {
        const chatMessages = $('#chatMessages');
        const timestamp = new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'});

        const messageHtml = `
          <div class="message user-message">
            <div class="message-content">
              <div class="message-text">${message}</div>
              <div class="message-time">You • ${timestamp}</div>
            </div>
            <div class="message-avatar">
              <i class="fas fa-user"></i>
            </div>
          </div>
        `;

        chatMessages.append(messageHtml);
        chatMessages.scrollTop(chatMessages[0].scrollHeight);
      }

      function addAIResponse(message, isQuickAction = false) {
        const chatMessages = $('#chatMessages');
        const timestamp = new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute: '2-digit'});

        // Generate contextual AI responses based on user input
        let aiResponse = message;
        if (!isQuickAction) {
          if (message.toLowerCase().includes('bail')) {
            aiResponse = 'Regarding bail prospects: Based on the Section 420 charges, courts typically consider factors like flight risk, criminal history, and community ties. Given the clean record and cooperation shown, I\'d recommend preparing strong surety documentation and character references. Would you like me to draft a bail application outline?';
          } else if (message.toLowerCase().includes('evidence')) {
            aiResponse = 'For evidence analysis: The case appears to rely heavily on documentary evidence and witness testimony. I\'ve reviewed the FIR and related documents. The prosecution\'s case has some gaps we can exploit. Shall I provide a detailed evidence analysis with defense strategies?';
          } else if (message.toLowerCase().includes('precedent') || message.toLowerCase().includes('case law')) {
            aiResponse = 'Regarding legal precedents: I can find relevant case law for Section 420 IPC cases. Similar economic offense cases have shown favorable outcomes when defendants demonstrate cooperation and have clean records. Would you like me to compile relevant judgments and citations?';
          } else if (message.toLowerCase().includes('strategy')) {
            aiResponse = 'For case strategy: I recommend a multi-pronged approach: 1) Challenge evidence admissibility, 2) Emphasize cooperation and clean record, 3) Highlight economic hardship arguments. We should also prepare for anticipatory bail immediately. What aspect would you like me to elaborate on?';
          } else {
            aiResponse = `I understand you\'re asking about "${message}". Based on the case details for State vs. John Doe, I can provide specific analysis and recommendations. Could you be more specific about what aspect you\'d like me to focus on - legal strategy, document analysis, or case law research?`;
          }
        }

        const messageHtml = `
          <div class="message ai-message">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              <div class="message-text">${aiResponse}</div>
              <div class="message-time">AI Assistant • ${timestamp}</div>
            </div>
          </div>
        `;

        chatMessages.append(messageHtml);
        chatMessages.scrollTop(chatMessages[0].scrollHeight);
      }

      // Enter key to send message
      $('#chatInput').on('keypress', function(e) {
        if (e.which === 13) {
          sendMessage();
        }
      });

      // Edit Case Function - Redirect to create-case.html in edit mode
      function editCase() {
        // Get current case ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const caseId = urlParams.get("id") || "1";

        // Redirect to create-case.html with edit mode and case ID
        window.location.href = `create-case.html?mode=edit&id=${caseId}`;
      }

      // Add Update Modal Functions
      function openAddUpdateModal() {
        // Set current date/time as default
        const now = new Date();
        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
        $('#updateDate').val(now.toISOString().slice(0, 16));

        $('#addUpdateModal').show();
      }

      function closeAddUpdateModal() {
        $('#addUpdateModal').hide();
        $('#addUpdateForm')[0].reset();
      }

      function saveUpdate() {
        const form = $('#addUpdateForm')[0];
        const formData = new FormData(form);

        // Basic validation
        if (!formData.get('updateTitle') || !formData.get('updateNotes')) {
          alert('Please fill in all required fields');
          return;
        }

        // Create new update object
        const newUpdate = {
          title: formData.get('updateTitle'),
          date: formData.get('updateDate'),
          category: formData.get('updateCategory'),
          priority: formData.get('updatePriority'),
          notes: formData.get('updateNotes'),
          nextAction: formData.get('nextAction'),
          documents: formData.get('documentsAttached')
        };

        // Add to timeline (you can extend this to add to a global updates array)
        addUpdateToTimeline(newUpdate);

        // Close modal
        closeAddUpdateModal();

        alert('Update added successfully!');
      }

      function addUpdateToTimeline(update) {
        const updateDate = new Date(update.date);
        const formattedDate = updateDate.toLocaleDateString('en-IN', {
          year: 'numeric',
          month: 'short',
          day: 'numeric'
        });

        const priorityColor = {
          'Low': '#10b981',
          'Medium': '#f59e0b',
          'High': '#ef4444',
          'Urgent': '#dc2626'
        };

        const newTimelineItem = `
          <div class="timeline-item">
            <div class="timeline-content">
              <div class="timeline-header">
                <span class="timeline-title">${update.title}</span>
                <span class="timeline-date">${formattedDate}</span>
              </div>
              <div class="timeline-description">
                ${update.category ? `<strong>Category:</strong> ${update.category}<br>` : ''}
                <strong>Priority:</strong> <span style="color: ${priorityColor[update.priority] || '#64748b'}">${update.priority}</span><br>
                <strong>Notes:</strong> ${update.notes}
                ${update.nextAction ? `<br><strong>Next Action:</strong> ${update.nextAction}` : ''}
                ${update.documents ? `<br><strong>Documents:</strong> ${update.documents}` : ''}
              </div>
            </div>
          </div>
        `;

        // Add to both full timeline and recent updates
        $('#fullTimeline').prepend(newTimelineItem);

        // Also add to recent updates in overview (limit to 2 items)
        const recentUpdatesTimeline = $('.sidebar .timeline');
        recentUpdatesTimeline.prepend(newTimelineItem);

        // Remove oldest item if more than 2
        const recentItems = recentUpdatesTimeline.find('.timeline-item');
        if (recentItems.length > 2) {
          recentItems.last().remove();
        }
      }

      // Modal overlay clicks to close
      $('#addUpdateModal').on('click', function(e) {
        if (e.target === this) {
          closeAddUpdateModal();
        }
      });
    </script>
  </body>
</html>
